<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<META http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta content="Apache Forrest" name="Generator">
<meta name="Forrest-version" content="0.8">
<meta name="Forrest-skin-name" content="pelt">
<title>CapacityScheduler Guide</title>
<link type="text/css" href="skin/basic.css" rel="stylesheet">
<link media="screen" type="text/css" href="skin/screen.css" rel="stylesheet">
<link media="print" type="text/css" href="skin/print.css" rel="stylesheet">
<link type="text/css" href="skin/profile.css" rel="stylesheet">
<script src="skin/getBlank.js" language="javascript" type="text/javascript"></script><script src="skin/getMenu.js" language="javascript" type="text/javascript"></script><script src="skin/fontsize.js" language="javascript" type="text/javascript"></script>
<link rel="shortcut icon" href="images/favicon.ico">
</head>
<body onload="init()">
<script type="text/javascript">ndeSetTextSize();</script>
<div id="top">
<!--+
    |breadtrail
    +-->
<div class="breadtrail">
<a href="http://www.apache.org/">Apache</a> &gt; <a href="http://hadoop.apache.org/">Hadoop</a> &gt; <a href="http://hadoop.apache.org/core/">Core</a><script src="skin/breadcrumbs.js" language="JavaScript" type="text/javascript"></script>
</div>
<!--+
    |header
    +-->
<div class="header">
<!--+
    |start group logo
    +-->
<div class="grouplogo">
<a href="http://hadoop.apache.org/"><img class="logoImage" alt="Hadoop" src="images/hadoop-logo.jpg" title="Apache Hadoop"></a>
</div>
<!--+
    |end group logo
    +-->
<!--+
    |start Project Logo
    +-->
<div class="projectlogo">
<a href="http://hadoop.apache.org/core/"><img class="logoImage" alt="Hadoop" src="images/hadoop-logo-2.gif" title="Scalable Computing Platform"></a>
</div>
<!--+
    |end Project Logo
    +-->
<!--+
    |start Search
    +-->
<div class="searchbox">
<form action="http://www.google.com/search" method="get" class="roundtopsmall">
<input value="hadoop.apache.org" name="sitesearch" type="hidden"><input onFocus="getBlank (this, 'Search the site with google');" size="25" name="q" id="query" type="text" value="Search the site with google">&nbsp; 
                    <input name="Search" value="Search" type="submit">
</form>
</div>
<!--+
    |end search
    +-->
<!--+
    |start Tabs
    +-->
<ul id="tabs">
<li>
<a class="unselected" href="http://hadoop.apache.org/core/">Project</a>
</li>
<li>
<a class="unselected" href="http://wiki.apache.org/hadoop">Wiki</a>
</li>
<li class="current">
<a class="selected" href="index.html">Hadoop 0.20.204.0 Documentation</a>
</li>
</ul>
<!--+
    |end Tabs
    +-->
</div>
</div>
<div id="main">
<div id="publishedStrip">
<!--+
    |start Subtabs
    +-->
<div id="level2tabs"></div>
<!--+
    |end Endtabs
    +-->
<script type="text/javascript"><!--
document.write("Last Published: " + document.lastModified);
//  --></script>
</div>
<!--+
    |breadtrail
    +-->
<div class="breadtrail">

             &nbsp;
           </div>
<!--+
    |start Menu, mainarea
    +-->
<!--+
    |start Menu
    +-->
<div id="menu">
<div onclick="SwitchMenu('menu_1.1', 'skin/')" id="menu_1.1Title" class="menutitle">Getting Started</div>
<div id="menu_1.1" class="menuitemgroup">
<div class="menuitem">
<a href="index.html">Overview</a>
</div>
<div class="menuitem">
<a href="single_node_setup.html">Single Node Setup</a>
</div>
<div class="menuitem">
<a href="cluster_setup.html">Cluster Setup</a>
</div>
</div>
<div onclick="SwitchMenu('menu_selected_1.2', 'skin/')" id="menu_selected_1.2Title" class="menutitle" style="background-image: url('skin/images/chapter_open.gif');">MapReduce</div>
<div id="menu_selected_1.2" class="selectedmenuitemgroup" style="display: block;">
<div class="menuitem">
<a href="mapred_tutorial.html">MapReduce Tutorial</a>
</div>
<div class="menuitem">
<a href="streaming.html">Hadoop Streaming</a>
</div>
<div class="menuitem">
<a href="commands_manual.html">Hadoop Commands</a>
</div>
<div class="menuitem">
<a href="distcp.html">DistCp</a>
</div>
<div class="menuitem">
<a href="vaidya.html">Vaidya</a>
</div>
<div class="menuitem">
<a href="hadoop_archives.html">Hadoop Archives</a>
</div>
<div class="menuitem">
<a href="gridmix.html">Gridmix</a>
</div>
<div class="menupage">
<div class="menupagetitle">Capacity Scheduler</div>
</div>
<div class="menuitem">
<a href="fair_scheduler.html">Fair Scheduler</a>
</div>
<div class="menuitem">
<a href="hod_scheduler.html">Hod Scheduler</a>
</div>
</div>
<div onclick="SwitchMenu('menu_1.3', 'skin/')" id="menu_1.3Title" class="menutitle">HDFS</div>
<div id="menu_1.3" class="menuitemgroup">
<div class="menuitem">
<a href="hdfs_user_guide.html">HDFS Users </a>
</div>
<div class="menuitem">
<a href="hdfs_design.html">HDFS Architecture</a>
</div>
<div class="menuitem">
<a href="hdfs_permissions_guide.html">Permissions</a>
</div>
<div class="menuitem">
<a href="hdfs_quota_admin_guide.html">Quotas</a>
</div>
<div class="menuitem">
<a href="SLG_user_guide.html">Synthetic Load Generator</a>
</div>
<div class="menuitem">
<a href="libhdfs.html">C API libhdfs</a>
</div>
</div>
<div onclick="SwitchMenu('menu_1.4', 'skin/')" id="menu_1.4Title" class="menutitle">Common</div>
<div id="menu_1.4" class="menuitemgroup">
<div class="menuitem">
<a href="deployment_layout.html">Deployment Layout</a>
</div>
<div class="menuitem">
<a href="file_system_shell.html">File System Shell</a>
</div>
<div class="menuitem">
<a href="service_level_auth.html">Service Level Authorization</a>
</div>
<div class="menuitem">
<a href="native_libraries.html">Native Libraries</a>
</div>
</div>
<div onclick="SwitchMenu('menu_1.5', 'skin/')" id="menu_1.5Title" class="menutitle">Miscellaneous</div>
<div id="menu_1.5" class="menuitemgroup">
<div class="menuitem">
<a href="Secure_Impersonation.html">Secure Impersonation</a>
</div>
<div class="menuitem">
<a href="api/index.html">API Docs</a>
</div>
<div class="menuitem">
<a href="jdiff/changes.html">API Changes</a>
</div>
<div class="menuitem">
<a href="http://wiki.apache.org/hadoop/">Wiki</a>
</div>
<div class="menuitem">
<a href="http://wiki.apache.org/hadoop/FAQ">FAQ</a>
</div>
<div class="menuitem">
<a href="releasenotes.html">Release Notes</a>
</div>
<div class="menuitem">
<a href="changes.html">Change Log</a>
</div>
</div>
<div id="credit"></div>
<div id="roundbottom">
<img style="display: none" class="corner" height="15" width="15" alt="" src="skin/images/rc-b-l-15-1body-2menu-3menu.png"></div>
<!--+
  |alternative credits
  +-->
<div id="credit2"></div>
</div>
<!--+
    |end Menu
    +-->
<!--+
    |start content
    +-->
<div id="content">
<div title="Portable Document Format" class="pdflink">
<a class="dida" href="capacity_scheduler.pdf"><img alt="PDF -icon" src="skin/images/pdfdoc.gif" class="skin"><br>
        PDF</a>
</div>
<h1>CapacityScheduler Guide</h1>
<div id="minitoc-area">
<ul class="minitoc">
<li>
<a href="#Purpose">Purpose</a>
</li>
<li>
<a href="#Overview">Overview</a>
</li>
<li>
<a href="#Features">Features</a>
</li>
<li>
<a href="#Installation">Installation</a>
</li>
<li>
<a href="#Configuration">Configuration</a>
<ul class="minitoc">
<li>
<a href="#Using+the+CapacityScheduler">Using the CapacityScheduler</a>
</li>
<li>
<a href="#Setting+up+queues">Setting up queues</a>
</li>
<li>
<a href="#Queue+properties">Queue properties</a>
<ul class="minitoc">
<li>
<a href="#Resource+allocation">Resource allocation</a>
</li>
<li>
<a href="#Job+initialization">Job initialization</a>
</li>
</ul>
</li>
<li>
<a href="#Resource+based+scheduling">Resource based scheduling</a>
</li>
<li>
<a href="#Reviewing+the+configuration+of+the+CapacityScheduler">Reviewing the configuration of the CapacityScheduler</a>
</li>
</ul>
</li>
<li>
<a href="#Example">Example</a>
</li>
</ul>
</div>
  
    
<a name="N1000D"></a><a name="Purpose"></a>
<h2 class="h3">Purpose</h2>
<div class="section">
<p>This document describes the CapacityScheduler, a pluggable 
      MapReduce scheduler for Hadoop which allows for multiple-tenants to 
      securely share a large cluster such that their applications are allocated
      resources in a timely manner under constraints of allocated capacities.
      </p>
</div>
    
    
<a name="N10017"></a><a name="Overview"></a>
<h2 class="h3">Overview</h2>
<div class="section">
<p>The CapacityScheduler is designed to run Hadoop Map-Reduce as a 
      shared, multi-tenant cluster in an operator-friendly manner while 
      maximizing the throughput and the utilization of the cluster while
      running Map-Reduce applications. </p>
<p>Traditionally each organization has it own private set of compute 
      resources that have sufficient capacity to meet the organization's SLA 
      under peak or near peak conditions. This generally leads to poor average 
      utilization and the overhead of managing multiple independent clusters, 
      one per each organization. Sharing clusters between organizations is a 
      cost-effective manner of running large Hadoop installations since this 
      allows them to reap benefits of economies of scale without creating 
      private clusters.  However, organizations are concerned about sharing a 
      cluster because they are worried about others using the resources that 
      are critical for their SLAs.</p>
<p>The CapacityScheduler is designed to allow sharing a large cluster 
      while giving  each organization a minimum capacity guarantee. The central 
      idea is that the available resources in the Hadoop Map-Reduce cluster are 
      partitioned among multiple organizations who collectively fund the 
      cluster based on computing needs. There is an added benefit that an 
      organization can access any excess capacity no being used by others. This 
      provides elasticity for the organizations in a cost-effective manner.</p>
<p>Sharing clusters across organizations necessitates strong support for
      multi-tenancy since each organization must be guaranteed capacity and 
      safe-guards to ensure the shared cluster is impervious to single rouge 
      job or user. The CapacityScheduler provides a stringent set of limits to 
      ensure that a single job or user or queue cannot consume dispropotionate 
      amount of resources in the cluster. Also, the JobTracker of the cluster,  
      in particular, is a precious resource and the CapacityScheduler provides 
      limits on initialized/pending tasks and jobs from a single user and queue 
      to ensure fairness and stability of the cluster.</p>
<p>The primary abstraction provided by the CapacityScheduler is the 
      concept of <em>queues</em>. These queues are typically setup by administrators
      to reflect the economics of the shared cluster.</p>
</div>
    
    
<a name="N10030"></a><a name="Features"></a>
<h2 class="h3">Features</h2>
<div class="section">
<p>The CapacityScheduler supports the following features:</p>
<ul>
        
<li>
          Capacity Guarantees - Support for multiple queues, where a job is 
          submitted to a queue.Queues are allocated a fraction of the capacity 
          of the grid in the sense that a certain capacity of resources will be 
          at their disposal. All jobs submitted to a queue will have access to 
          the capacity allocated to the queue. Adminstrators can configure soft 
          limits and optional hard limits on the capacity allocated to each queue. 
        </li>
        
<li>
          Security - Each queue has strict ACLs which controls which users can 
          submit jobs to individual queues. Also, there are safe-guards to 
          ensure that users cannot view and/or modify jobs from other users if
          so desired. Also, per-queue and system administrator roles are 
          supported.
        </li>
        
<li>
          Elasticity - Free resources can be allocated to any queue beyond it's 
          capacity. When there is demand for these resources from queues running 
          below capacity at a future point in time, as tasks scheduled on these 
          resources complete, they will be assigned to jobs on queues 
          running below the capacity. This ensures that resources are available 
          in a predictable and elastic manner to queues, thus preventing 
          artifical silos of resources in the cluster which helps utilization.
        </li>
        
<li>
          Multi-tenancy - Comprehensive set of limits are provided to prevent 
          a single job, user and queue from monpolizing resources of the queue 
          or the cluster as a whole to ensure that the system, particularly the 
          JobTracker, isn't overwhelmed by too many tasks or jobs. 
        </li>
        
<li>
          Operability - The queue definitions and properties can be changed, 
          at runtime, by administrators in a secure manner to minimize 
          disruption to users. Also, a console is provided for users and 
          administrators to view current allocation of resources to various 
          queues in the system.
        </li>
        
<li>
          Resource-based Scheduling - Support for resource-intensive jobs, 
          wherein a job can optionally specify higher resource-requirements than 
          the default, there-by accomodating applications with differing resource
          requirements. Currently, memory is the the resource requirement 
          supported.
        </li>
        
<li>
          Job Priorities - Queues optionally support job priorities (disabled 
          by default). Within a queue, jobs with higher priority will have 
          access to the queue's resources before jobs with lower priority. 
          However, once a job is running, it will not be preempted for a higher 
          priority job, <em>premption</em> is on the roadmap is currently not 
          supported.
        </li>
      
</ul>
</div>
    
    
<a name="N10055"></a><a name="Installation"></a>
<h2 class="h3">Installation</h2>
<div class="section">
<p>The CapacityScheduler is available as a JAR file in the Hadoop
        tarball under the <em>contrib/capacity-scheduler</em> directory. The name of 
        the JAR file would be on the lines of hadoop-capacity-scheduler-*.jar.</p>
<p>You can also build the Scheduler from source by executing
        <em>ant package</em>, in which case it would be available under
        <em>build/contrib/capacity-scheduler</em>.</p>
<p>To run the CapacityScheduler in your Hadoop installation, you need 
        to put it on the <em>CLASSPATH</em>. The easiest way is to copy the 
        <span class="codefrag">hadoop-capacity-scheduler-*.jar</span> from 
        to <span class="codefrag">HADOOP_HOME/lib</span>. Alternatively, you can modify 
        <em>HADOOP_CLASSPATH</em> to include this jar, in 
        <span class="codefrag">conf/hadoop-env.sh</span>.</p>
</div>

    
<a name="N1007D"></a><a name="Configuration"></a>
<h2 class="h3">Configuration</h2>
<div class="section">
<a name="N10083"></a><a name="Using+the+CapacityScheduler"></a>
<h3 class="h4">Using the CapacityScheduler</h3>
<p>
          To make the Hadoop framework use the CapacityScheduler, set up
          the following property in the site configuration:</p>
<table class="ForrestTable" cellspacing="1" cellpadding="4">
            
<tr>
              
<td colspan="1" rowspan="1">Property</td>
              <td colspan="1" rowspan="1">Value</td>
            
</tr>
            
<tr>
              
<td colspan="1" rowspan="1">mapred.jobtracker.taskScheduler</td>
              <td colspan="1" rowspan="1">org.apache.hadoop.mapred.CapacityTaskScheduler</td>
            
</tr>
          
</table>
<a name="N100AA"></a><a name="Setting+up+queues"></a>
<h3 class="h4">Setting up queues</h3>
<p>
          You can define multiple queues to which users can submit jobs with
          the CapacityScheduler. To define multiple queues, you should use the  
          <em>mapred.queue.names</em> property in 
          <span class="codefrag">conf/hadoop-site.xml</span>.
        </p>
<p>
          The CapacityScheduler can be configured with several properties
          for each queue that control the behavior of the Scheduler. This
          configuration is in the <em>conf/capacity-scheduler.xml</em>.
        </p>
<p>
          You can also configure ACLs for controlling which users or groups
          have access to the queues in <span class="codefrag">conf/mapred-queue-acls.xml</span>.
        </p>
<p>
          For more details, refer to
          <a href="cluster_setup.html#Configuring+the+Hadoop+Daemons">Cluster 
          Setup</a> documentation.
        </p>
<a name="N100CD"></a><a name="Queue+properties"></a>
<h3 class="h4">Queue properties</h3>
<a name="N100D3"></a><a name="Resource+allocation"></a>
<h4>Resource allocation</h4>
<p>The properties defined for resource allocations to queues and their 
        descriptions are listed in below:</p>
<table class="ForrestTable" cellspacing="1" cellpadding="4">
          
<tr>
<th colspan="1" rowspan="1">Name</th><th colspan="1" rowspan="1">Description</th>
</tr>
          
<tr>
<td colspan="1" rowspan="1">mapred.capacity-scheduler.queue.&lt;queue-name&gt;.capacity</td>
          	<td colspan="1" rowspan="1">Percentage of the number of slots in the cluster that are made 
            to be available for jobs in this queue. The sum of capacities 
            for all queues should be less than or equal 100.</td>
          
</tr>
          
<tr>
<td colspan="1" rowspan="1">mapred.capacity-scheduler.queue.&lt;queue-name&gt;.maximum-capacity</td>
            <td colspan="1" rowspan="1">
                  maximum-capacity defines a limit beyond which a queue cannot
                  use the capacity of the cluster.This provides a means to limit
                  how much excess capacity a queue can use. By default, there
                  is no limit.
                  The maximum-capacity of a queue can only be greater than or
                  equal to its minimum capacity.
                  Default value of -1 implies a queue can use complete capacity
                  of the cluster.

                  This property could be to curtail certain jobs which are long
                  running in nature from occupying more than a certain
                  percentage of the cluster, which in the absence of
                  pre-emption, could lead to capacity guarantees of other queues
                  being affected.

                  One important thing to note is that maximum-capacity is a
                  percentage , so based on the cluster's capacity
                  it would change. So if large no of nodes or racks get added
                  to the cluster , maximum Capacity in
                  absolute terms would increase accordingly.
                </td>
          
</tr>
          
<tr>
<td colspan="1" rowspan="1">mapred.capacity-scheduler.queue.&lt;queue-name&gt;.minimum-user-limit-percent</td>
          	<td colspan="1" rowspan="1">Each queue enforces a limit on the percentage of resources 
          	allocated to a user at any given time, if there is competition 
          	for them. This user limit can vary between a minimum and maximum 
          	value. The former depends on the number of users who have submitted
          	jobs, and the latter is set to this property value. For example, 
          	suppose the value of this property is 25. If two users have 
          	submitted jobs to a queue, no single user can use more than 50% 
          	of the queue resources. If a third user submits a job, no single 
          	user can use more than 33% of the queue resources. With 4 or more 
          	users, no user can use more than 25% of the queue's resources. A 
          	value of 100 implies no user limits are imposed.</td>
          
</tr>
          
<tr>
<td colspan="1" rowspan="1">mapred.capacity-scheduler.queue.&lt;queue-name&gt;.user-limit-factor</td>
            <td colspan="1" rowspan="1">The multiple of the queue capacity which can be configured to 
              allow a single user to acquire more slots. By default this is set 
              to 1 which ensure that a single user can never take more than the 
              queue's configured capacity irrespective of how idle th cluster 
              is.</td>
          
</tr>
          
<tr>
<td colspan="1" rowspan="1">mapred.capacity-scheduler.queue.&lt;queue-name&gt;.supports-priority</td>
            <td colspan="1" rowspan="1">If true, priorities of jobs will be taken into account in scheduling 
            decisions.</td>
          
</tr>
        
</table>
<a name="N10126"></a><a name="Job+initialization"></a>
<h4>Job initialization</h4>
<p>Capacity scheduler lazily initializes the jobs before they are
        scheduled, for reducing the memory footprint on jobtracker. 
        Following are the parameters, by which you can control the
        initialization of jobs per-queue.
        </p>
<table class="ForrestTable" cellspacing="1" cellpadding="4">
          
<tr>
<th colspan="1" rowspan="1">Name</th><th colspan="1" rowspan="1">Description</th>
</tr>
          
<tr>
            
<td colspan="1" rowspan="1">
              mapred.capacity-scheduler.maximum-system-jobs
            </td>
            <td colspan="1" rowspan="1">
              Maximum number of jobs in the system which can be initialized,
              concurrently, by the CapacityScheduler.
              
              Individual queue limits on initialized jobs are directly 
              proportional to their queue capacities.
            </td>
          
</tr>
          
<tr>
            
<td colspan="1" rowspan="1">
              mapred.capacity-scheduler.queue.&lt;queue-name&gt;.maximum-initialized-active-tasks
            </td>
            <td colspan="1" rowspan="1">
              The maximum number of tasks, across all jobs in the queue, 
              which can be initialized concurrently. Once the queue's jobs 
              exceed this limit they will be queued on disk.             
            </td>
          
</tr>
          
<tr>
            
<td colspan="1" rowspan="1">
              mapred.capacity-scheduler.queue.&lt;queue-name&gt;.maximum-initialized-active-tasks-per-user
            </td>
            <td colspan="1" rowspan="1">
              The maximum number of tasks per-user, across all the of the
              user's jobs in the queue, which can be initialized concurrently. 
              Once the user's jobs exceed this limit they will be queued on disk.
            </td>
          
</tr>
          
<tr>
            
<td colspan="1" rowspan="1"> 
              mapred.capacity-scheduler.queue.&lt;queue-name&gt;.init-accept-jobs-factor
            </td>
            <td colspan="1" rowspan="1">
              The multipe of (maximum-system-jobs * queue-capacity) used to
              determine the number of jobs which are accepted by the scheduler. 
              The default value is 10. If number of jobs submitted to the queue
              exceeds this limit, job submission are rejected. 
            </td>
          
</tr> 
        
</table>
<a name="N10172"></a><a name="Resource+based+scheduling"></a>
<h3 class="h4">Resource based scheduling</h3>
<p>The CapacityScheduler supports scheduling of tasks on a
        <span class="codefrag">TaskTracker</span>(TT) based on a job's memory requirements
        in terms of RAM and Virtual Memory (VMEM) on the TT node.
        A TT is conceptually composed of a fixed number of map and reduce
        slots with fixed slot size across the cluster. A job can ask for one
        or more slots for each of its component map and/or reduce slots. If a
        task consumes more memory than configured the TT forcibly kills the task.
        </p>
<p>Currently the memory based scheduling is only supported
        in Linux platform.</p>
<p>Additional scheduler-based config 
        parameters are as follows:</p>
<table class="ForrestTable" cellspacing="1" cellpadding="4">
          
<tr>
<th colspan="1" rowspan="1">Name</th><th colspan="1" rowspan="1">Description</th>
</tr>
          
<tr>
            
<td colspan="1" rowspan="1">mapred.cluster.map.memory.mb</td>
          	 <td colspan="1" rowspan="1">The size, in terms of virtual memory, of a single map slot
             in the Map-Reduce framework, used by the scheduler.
             A job can ask for multiple slots for a single map task via
             <span class="codefrag">mapred.job.map.memory.mb</span>, upto the limit specified by
             <span class="codefrag">mapred.cluster.max.map.memory.mb</span>, if the scheduler 
             supports the feature.
             The value of -1 indicates that this feature is turned off.
          	 </td>
          
</tr>
          
<tr>
            
<td colspan="1" rowspan="1">mapred.cluster.reduce.memory.mb</td>
             <td colspan="1" rowspan="1">The size, in terms of virtual memory, of a single reduce slot
             in the Map-Reduce framework, used by the scheduler.
             A job can ask for multiple slots for a single reduce task via
             <span class="codefrag">mapred.job.reduce.memory.mb</span>, upto the limit specified by
             <span class="codefrag">mapred.cluster.max.reduce.memory.mb</span>, if the scheduler supports the 
             feature.The value of -1 indicates that this feature is turned off.
             </td>
          
</tr>
          
<tr>
            
<td colspan="1" rowspan="1">mapred.cluster.max.map.memory.mb</td>
            <td colspan="1" rowspan="1">The maximum size, in terms of virtual memory, of a single map
            task launched by the Map-Reduce framework, used by the scheduler.
            A job can ask for multiple slots for a single map task via
            <span class="codefrag">mapred.job.map.memory.mb</span>, upto the limit specified by
            <span class="codefrag">mapred.cluster.max.map.memory.mb</span>, if the scheduler supports the 
            feature. The value of -1 indicates that this feature is turned off.
            </td>
          
</tr>
          
<tr>
            
<td colspan="1" rowspan="1">mapred.cluster.max.reduce.memory.mb</td>
            <td colspan="1" rowspan="1">The maximum size, in terms of virtual memory, of a single reduce
            task launched by the Map-Reduce framework, used by the scheduler.
            A job can ask for multiple slots for a single reduce task via
            <span class="codefrag">mapred.job.reduce.memory.mb</span>, upto the limit specified by
            <span class="codefrag">mapred.cluster.max.reduce.memory.mb</span>, if the scheduler supports the 
            feature. The value of -1 indicates that this feature is turned off.
            </td>
          
</tr>
          
<tr>
            
<td colspan="1" rowspan="1">mapred.job.map.memory.mb</td>
            <td colspan="1" rowspan="1">The size, in terms of virtual memory, of a single map task
            for the job. A job can ask for multiple slots for a single map task, 
            rounded up to the next multiple of <span class="codefrag">mapred.cluster.map.memory.mb</span> and 
            upto the limit specified by <span class="codefrag">mapred.cluster.max.map.memory.mb</span>, 
            if the scheduler supports the feature. The value of -1 indicates 
            that this feature is turned off iff <span class="codefrag">mapred.cluster.map.memory.mb</span> is 
            also turned off (-1).</td>
          
</tr>
          
<tr>
            
<td colspan="1" rowspan="1">mapred.job.reduce.memory.mb</td>
            <td colspan="1" rowspan="1">The size, in terms of virtual memory, of a single reduce task
            for the job. A job can ask for multiple slots for a single reduce task, 
            rounded up to the next multiple of <span class="codefrag">mapred.cluster.reduce.memory.mb</span> and 
            upto the limit specified by <span class="codefrag">mapred.cluster.max.reduce.memory.mb</span>, 
            if the scheduler supports the feature. The value of -1 indicates 
            that this feature is turned off iff <span class="codefrag">mapred.cluster.reduce.memory.mb</span> is 
            also turned off (-1).</td>
          
</tr>
        
</table>
<a name="N1020A"></a><a name="Reviewing+the+configuration+of+the+CapacityScheduler"></a>
<h3 class="h4">Reviewing the configuration of the CapacityScheduler</h3>
<p>
          Once the installation and configuration is completed, you can review
          it after starting the MapReduce cluster from the admin UI.
        </p>
<ul>
          
<li>Start the MapReduce cluster as usual.</li>
          
<li>Open the JobTracker web UI.</li>
          
<li>The queues you have configured should be listed under the <em>Scheduling
              Information</em> section of the page.</li>
          
<li>The properties for the queues should be visible in the <em>Scheduling
              Information</em> column against each queue.</li>
          
<li>The /scheduler web-page should show the resource usages of 
              individual queues.</li>
        
</ul>
</div>

  
<a name="N1022D"></a><a name="Example"></a>
<h2 class="h3">Example</h2>
<div class="section">
<p>Here is a practical example for using CapacityScheduler:</p>
<table class="ForrestTable" cellspacing="1" cellpadding="4">
    
<tr>
    
<td colspan="1" rowspan="1">
<span class="codefrag">&lt;?xml version="1.0"?&gt;</span>
<br>

<br>

<span class="codefrag">&lt;configuration&gt;</span>
<br>

<br>

<span class="codefrag">  &lt;!-- system limit, across all queues --&gt;</span>
<br>

<br>

<span class="codefrag">  &lt;property&gt;</span>
<br>

<span class="codefrag">    &nbsp;&nbsp;&lt;name&gt;mapred.capacity-scheduler.maximum-system-jobs&lt;/name&gt;</span>
<br>

<span class="codefrag">    &nbsp;&nbsp;&lt;value&gt;3000&lt;/value&gt;</span>
<br>

<span class="codefrag">    &lt;description&gt;Maximum number of jobs in the system which can be initialized,</span>
<br>

<span class="codefrag">     concurrently, by the CapacityScheduler.</span>
<br>

<span class="codefrag">    &lt;/description&gt;    </span>
<br>

<span class="codefrag">  &lt;/property&gt;</span>
<br>

<span class="codefrag"> </span>
<br>

<span class="codefrag">&lt;!-- queue: queueA --&gt;</span>
<br>

<span class="codefrag"> &lt;property&gt;</span>
<br>

<span class="codefrag">    &nbsp;&nbsp;&lt;name&gt;mapred.capacity-scheduler.queue.queueA.capacity&lt;/name&gt;</span>
<br>

<span class="codefrag">    &nbsp;&nbsp;&lt;value&gt;8&lt;/value&gt;</span>
<br>

<span class="codefrag">  &lt;/property&gt;</span>
<br>

<span class="codefrag">  &lt;property&gt;</span>
<br>

<span class="codefrag">    &nbsp;&nbsp;&lt;name&gt;mapred.capacity-scheduler.queue.queueA.supports-priority&lt;/name&gt;</span>
<br>

<span class="codefrag">    &nbsp;&nbsp;&lt;value&gt;false&lt;/value&gt;</span>
<br>

<span class="codefrag">  &lt;/property&gt;</span>
<br>

<span class="codefrag">  &lt;property&gt;</span>
<br>

<span class="codefrag">    &nbsp;&nbsp;&lt;name&gt;mapred.capacity-scheduler.queue.queueA.minimum-user-limit-percent&lt;/name&gt;</span>
<br>

<span class="codefrag">    &nbsp;&nbsp;&lt;value&gt;20&lt;/value&gt;</span>
<br>

<span class="codefrag">  &lt;/property&gt;</span>
<br>

<span class="codefrag">  &lt;property&gt;</span>
<br>

<span class="codefrag">    &nbsp;&nbsp;&lt;name&gt;mapred.capacity-scheduler.queue.queueA.user-limit-factor&lt;/name&gt;</span>
<br>

<span class="codefrag">    &nbsp;&nbsp;&lt;value&gt;10&lt;/value&gt;</span>
<br>

<span class="codefrag">  &lt;/property&gt;</span>
<br>

<span class="codefrag">  &lt;property&gt;</span>
<br>

<span class="codefrag">    &nbsp;&nbsp;&lt;name&gt;mapred.capacity-scheduler.queue.queueA.maximum-initialized-active-tasks&lt;/name&gt;</span>
<br>

<span class="codefrag">    &nbsp;&nbsp;&lt;value&gt;200000&lt;/value&gt;</span>
<br>

<span class="codefrag">  &lt;/property&gt;</span>
<br>

<span class="codefrag">  &lt;property&gt;</span>
<br>

<span class="codefrag">    &nbsp;&nbsp;&lt;name&gt;mapred.capacity-scheduler.queue.queueA.maximum-initialized-active-tasks-per-user&lt;/name&gt;</span>
<br>

<span class="codefrag">    &nbsp;&nbsp;&lt;value&gt;100000&lt;/value&gt;</span>
<br>

<span class="codefrag">  &lt;/property&gt;</span>
<br>

<span class="codefrag">  &lt;property&gt;</span>
<br>

<span class="codefrag">    &nbsp;&nbsp;&lt;name&gt;mapred.capacity-scheduler.queue.queueA.init-accept-jobs-factor&lt;/name&gt;</span>
<br>

<span class="codefrag">    &nbsp;&nbsp;&lt;value&gt;100&lt;/value&gt;</span>
<br>

<span class="codefrag">  &lt;/property&gt;</span>
<br>

<br>

<span class="codefrag">&lt;!-- queue: queueB --&gt;</span>
<br>

<span class="codefrag">  &lt;property&gt;</span>
<br>

<span class="codefrag">    &nbsp;&nbsp;&lt;name&gt;mapred.capacity-scheduler.queue.queueB.capacity&lt;/name&gt;</span>
<br>

<span class="codefrag">    &nbsp;&nbsp;&lt;value&gt;2&lt;/value&gt;</span>
<br>

<span class="codefrag">  &lt;/property&gt;</span>
<br>

<span class="codefrag">  &lt;property&gt;</span>
<br>

<span class="codefrag">    &nbsp;&nbsp;&lt;name&gt;mapred.capacity-scheduler.queue.queueB.supports-priority&lt;/name&gt;</span>
<br>

<span class="codefrag">    &nbsp;&nbsp;&lt;value&gt;false&lt;/value&gt;</span>
<br>

<span class="codefrag">  &lt;/property&gt;</span>
<br>

<span class="codefrag">  &lt;property&gt;</span>
<br>

<span class="codefrag">    &nbsp;&nbsp;&lt;name&gt;mapred.capacity-scheduler.queue.queueB.minimum-user-limit-percent&lt;/name&gt;</span>
<br>

<span class="codefrag">    &nbsp;&nbsp;&lt;value&gt;20&lt;/value&gt;</span>
<br>

<span class="codefrag">  &lt;/property&gt;</span>
<br>

<span class="codefrag">  &lt;property&gt;</span>
<br>

<span class="codefrag">    &nbsp;&nbsp;&lt;name&gt;mapred.capacity-scheduler.queue.queueB.user-limit-factor&lt;/name&gt;</span>
<br>

<span class="codefrag">    &nbsp;&nbsp;&lt;value&gt;1&lt;/value&gt;</span>
<br>

<span class="codefrag">  &lt;/property&gt;</span>
<br>

<span class="codefrag">  &lt;property&gt;</span>
<br>

<span class="codefrag">    &nbsp;&nbsp;&lt;name&gt;mapred.capacity-scheduler.queue.queueB.maximum-initialized-active-tasks&lt;/name&gt;</span>
<br>

<span class="codefrag">    &nbsp;&nbsp;&lt;value&gt;200000&lt;/value&gt;</span>
<br>

<span class="codefrag">  &lt;/property&gt;</span>
<br>

<span class="codefrag">  &lt;property&gt;</span>
<br>

<span class="codefrag">    &nbsp;&nbsp;&lt;name&gt;mapred.capacity-scheduler.queue.queueB.maximum-initialized-active-tasks-per-user&lt;/name&gt;</span>
<br>

<span class="codefrag">    &nbsp;&nbsp;&lt;value&gt;100000&lt;/value&gt;</span>
<br>

<span class="codefrag">  &lt;/property&gt;</span>
<br>

<span class="codefrag">  &lt;property&gt;</span>
<br>

<span class="codefrag">    &nbsp;&nbsp;&lt;name&gt;mapred.capacity-scheduler.queue.queueB.init-accept-jobs-factor&lt;/name&gt;</span>
<br>

<span class="codefrag">    &nbsp;&nbsp;&lt;value&gt;10&lt;/value&gt;</span>
<br>

<span class="codefrag">  &lt;/property&gt;</span>
<br>

<br>

<span class="codefrag">&lt;!-- queue: queueC --&gt;</span>
<br>

<span class="codefrag">  &lt;property&gt;</span>
<br>

<span class="codefrag">    &nbsp;&nbsp;&lt;name&gt;mapred.capacity-scheduler.queue.queueC.capacity&lt;/name&gt;</span>
<br>

<span class="codefrag">    &nbsp;&nbsp;&lt;value&gt;30&lt;/value&gt;</span>
<br>

<span class="codefrag">  &lt;/property&gt;</span>
<br>

<span class="codefrag">  &lt;property&gt;</span>
<br>

<span class="codefrag">    &nbsp;&nbsp;&lt;name&gt;mapred.capacity-scheduler.queue.queueC.supports-priority&lt;/name&gt;</span>
<br>

<span class="codefrag">    &nbsp;&nbsp;&lt;value&gt;false&lt;/value&gt;</span>
<br>

<span class="codefrag">  &lt;/property&gt;</span>
<br>

<span class="codefrag">  &lt;property&gt;</span>
<br>

<span class="codefrag">    &nbsp;&nbsp;&lt;name&gt;mapred.capacity-scheduler.queue.queueC.minimum-user-limit-percent&lt;/name&gt;</span>
<br>

<span class="codefrag">    &nbsp;&nbsp;&lt;value&gt;20&lt;/value&gt;</span>
<br>

<span class="codefrag">  &lt;/property&gt;</span>
<br>

<span class="codefrag">  &lt;property&gt;</span>
<br>

<span class="codefrag">    &nbsp;&nbsp;&lt;name&gt;mapred.capacity-scheduler.queue.queueC.user-limit-factor&lt;/name&gt;</span>
<br>

<span class="codefrag">    &nbsp;&nbsp;&lt;value&gt;1&lt;/value&gt;</span>
<br>

<span class="codefrag">  &lt;/property&gt;</span>
<br>

<span class="codefrag">  &lt;property&gt;</span>
<br>

<span class="codefrag">    &nbsp;&nbsp;&lt;name&gt;mapred.capacity-scheduler.queue.queueC.maximum-initialized-active-tasks&lt;/name&gt;</span>
<br>

<span class="codefrag">    &nbsp;&nbsp;&lt;value&gt;200000&lt;/value&gt;</span>
<br>

<span class="codefrag">  &lt;/property&gt;</span>
<br>

<span class="codefrag">  &lt;property&gt;</span>
<br>

<span class="codefrag">    &nbsp;&nbsp;&lt;name&gt;mapred.capacity-scheduler.queue.queueC.maximum-initialized-active-tasks-per-user&lt;/name&gt;</span>
<br>

<span class="codefrag">    &nbsp;&nbsp;&lt;value&gt;100000&lt;/value&gt;</span>
<br>

<span class="codefrag">  &lt;/property&gt;</span>
<br>

<span class="codefrag">  &lt;property&gt;</span>
<br>

<span class="codefrag">    &nbsp;&nbsp;&lt;name&gt;mapred.capacity-scheduler.queue.queueC.init-accept-jobs-factor&lt;/name&gt;</span>
<br>

<span class="codefrag">    &nbsp;&nbsp;&lt;value&gt;10&lt;/value&gt;</span>
<br>

<span class="codefrag">  &lt;/property&gt;</span>
<br>

<br>

<span class="codefrag">&lt;!-- queue: queueD --&gt;</span>
<br>

<span class="codefrag">  &lt;property&gt;</span>
<br>

<span class="codefrag">    &nbsp;&nbsp;&lt;name&gt;mapred.capacity-scheduler.queue.queueD.capacity&lt;/name&gt;</span>
<br>

<span class="codefrag">    &nbsp;&nbsp;&lt;value&gt;1&lt;/value&gt;</span>
<br>

<span class="codefrag">  &lt;/property&gt;</span>
<br>

<span class="codefrag">  &lt;property&gt;</span>
<br>

<span class="codefrag">    &nbsp;&nbsp;&lt;name&gt;mapred.capacity-scheduler.queue.queueD.supports-priority&lt;/name&gt;</span>
<br>

<span class="codefrag">    &nbsp;&nbsp;&lt;value&gt;false&lt;/value&gt;</span>
<br>

<span class="codefrag">  &lt;/property&gt;</span>
<br>

<span class="codefrag">  &lt;property&gt;</span>
<br>

<span class="codefrag">    &nbsp;&nbsp;&lt;name&gt;mapred.capacity-scheduler.queue.queueD.minimum-user-limit-percent&lt;/name&gt;</span>
<br>

<span class="codefrag">    &nbsp;&nbsp;&lt;value&gt;20&lt;/value&gt;</span>
<br>

<span class="codefrag">  &lt;/property&gt;</span>
<br>

<span class="codefrag">  &lt;property&gt;</span>
<br>

<span class="codefrag">    &nbsp;&nbsp;&lt;name&gt;mapred.capacity-scheduler.queue.queueD.user-limit-factor&lt;/name&gt;</span>
<br>

<span class="codefrag">    &nbsp;&nbsp;&lt;value&gt;20&lt;/value&gt;</span>
<br>

<span class="codefrag">  &lt;/property&gt;</span>
<br>

<span class="codefrag">  &lt;property&gt;</span>
<br>

<span class="codefrag">    &nbsp;&nbsp;&lt;name&gt;mapred.capacity-scheduler.queue.queueD.maximum-initialized-active-tasks&lt;/name&gt;</span>
<br>

<span class="codefrag">    &nbsp;&nbsp;&lt;value&gt;200000&lt;/value&gt;</span>
<br>

<span class="codefrag">  &lt;/property&gt;</span>
<br>

<span class="codefrag">  &lt;property&gt;</span>
<br>

<span class="codefrag">    &nbsp;&nbsp;&lt;name&gt;mapred.capacity-scheduler.queue.queueD.maximum-initialized-active-tasks-per-user&lt;/name&gt;</span>
<br>

<span class="codefrag">    &nbsp;&nbsp;&lt;value&gt;100000&lt;/value&gt;</span>
<br>

<span class="codefrag">  &lt;/property&gt;</span>
<br>

<span class="codefrag">  &lt;property&gt;</span>
<br>

<span class="codefrag">    &nbsp;&nbsp;&lt;name&gt;mapred.capacity-scheduler.queue.queueD.init-accept-jobs-factor&lt;/name&gt;</span>
<br>

<span class="codefrag">    &nbsp;&nbsp;&lt;value&gt;10&lt;/value&gt;</span>
<br>

<span class="codefrag">  &lt;/property&gt;</span>
<br>

<br>

<span class="codefrag">&lt;!-- queue: queueE --&gt;</span>
<br>

<span class="codefrag">  &lt;property&gt;</span>
<br>

<span class="codefrag">    &nbsp;&nbsp;&lt;name&gt;mapred.capacity-scheduler.queue.queueE.capacity&lt;/name&gt;</span>
<br>

<span class="codefrag">    &nbsp;&nbsp;&lt;value&gt;31&lt;/value&gt;</span>
<br>

<span class="codefrag">  &lt;/property&gt;</span>
<br>

<span class="codefrag">  &lt;property&gt;</span>
<br>

<span class="codefrag">    &nbsp;&nbsp;&lt;name&gt;mapred.capacity-scheduler.queue.queueE.supports-priority&lt;/name&gt;</span>
<br>

<span class="codefrag">    &nbsp;&nbsp;&lt;value&gt;false&lt;/value&gt;</span>
<br>

<span class="codefrag">  &lt;/property&gt;</span>
<br>

<span class="codefrag">  &lt;property&gt;</span>
<br>

<span class="codefrag">    &nbsp;&nbsp;&lt;name&gt;mapred.capacity-scheduler.queue.queueE.minimum-user-limit-percent&lt;/name&gt;</span>
<br>

<span class="codefrag">    &nbsp;&nbsp;&lt;value&gt;20&lt;/value&gt;</span>
<br>

<span class="codefrag">  &lt;/property&gt;</span>
<br>

<span class="codefrag">  &lt;property&gt;</span>
<br>

<span class="codefrag">    &nbsp;&nbsp;&lt;name&gt;mapred.capacity-scheduler.queue.queueE.user-limit-factor&lt;/name&gt;</span>
<br>

<span class="codefrag">    &nbsp;&nbsp;&lt;value&gt;1&lt;/value&gt;</span>
<br>

<span class="codefrag">  &lt;/property&gt;</span>
<br>

<span class="codefrag">  &lt;property&gt;</span>
<br>

<span class="codefrag">    &nbsp;&nbsp;&lt;name&gt;mapred.capacity-scheduler.queue.queueE.maximum-initialized-active-tasks&lt;/name&gt;</span>
<br>

<span class="codefrag">    &nbsp;&nbsp;&lt;value&gt;200000&lt;/value&gt;</span>
<br>

<span class="codefrag">  &lt;/property&gt;</span>
<br>

<span class="codefrag">  &lt;property&gt;</span>
<br>

<span class="codefrag">    &nbsp;&nbsp;&lt;name&gt;mapred.capacity-scheduler.queue.queueE.maximum-initialized-active-tasks-per-user&lt;/name&gt;</span>
<br>

<span class="codefrag">    &nbsp;&nbsp;&lt;value&gt;100000&lt;/value&gt;</span>
<br>

<span class="codefrag">  &lt;/property&gt;</span>
<br>

<span class="codefrag">  &lt;property&gt;</span>
<br>

<span class="codefrag">    &nbsp;&nbsp;&lt;name&gt;mapred.capacity-scheduler.queue.queueE.init-accept-jobs-factor&lt;/name&gt;</span>
<br>

<span class="codefrag">    &nbsp;&nbsp;&lt;value&gt;10&lt;/value&gt;</span>
<br>

<span class="codefrag">  &lt;/property&gt;</span>
<br>

<br>

<span class="codefrag">&lt;!-- queue: queueF --&gt;</span>
<br>

<span class="codefrag">  &lt;property&gt;</span>
<br>

<span class="codefrag">    &nbsp;&nbsp;&lt;name&gt;mapred.capacity-scheduler.queue.queueF.capacity&lt;/name&gt;</span>
<br>

<span class="codefrag">    &nbsp;&nbsp;&lt;value&gt;28&lt;/value&gt;</span>
<br>

<span class="codefrag">  &lt;/property&gt;</span>
<br>

<span class="codefrag">  &lt;property&gt;</span>
<br>

<span class="codefrag">    &nbsp;&nbsp;&lt;name&gt;mapred.capacity-scheduler.queue.queueF.supports-priority&lt;/name&gt;</span>
<br>

<span class="codefrag">    &nbsp;&nbsp;&lt;value&gt;false&lt;/value&gt;</span>
<br>

<span class="codefrag">  &lt;/property&gt;</span>
<br>

<span class="codefrag">  &lt;property&gt;</span>
<br>

<span class="codefrag">    &nbsp;&nbsp;&lt;name&gt;mapred.capacity-scheduler.queue.queueF.minimum-user-limit-percent&lt;/name&gt;</span>
<br>

<span class="codefrag">    &nbsp;&nbsp;&lt;value&gt;20&lt;/value&gt;</span>
<br>

<span class="codefrag">  &lt;/property&gt;</span>
<br>

<span class="codefrag">  &lt;property&gt;</span>
<br>

<span class="codefrag">    &nbsp;&nbsp;&lt;name&gt;mapred.capacity-scheduler.queue.queueF.user-limit-factor&lt;/name&gt;</span>
<br>

<span class="codefrag">    &nbsp;&nbsp;&lt;value&gt;1&lt;/value&gt;</span>
<br>

<span class="codefrag">  &lt;/property&gt;</span>
<br>

<span class="codefrag">  &lt;property&gt;</span>
<br>

<span class="codefrag">    &nbsp;&nbsp;&lt;name&gt;mapred.capacity-scheduler.queue.queueF.maximum-initialized-active-tasks&lt;/name&gt;</span>
<br>

<span class="codefrag">    &nbsp;&nbsp;&lt;value&gt;200000&lt;/value&gt;</span>
<br>

<span class="codefrag">  &lt;/property&gt;</span>
<br>

<span class="codefrag">  &lt;property&gt;</span>
<br>

<span class="codefrag">    &nbsp;&nbsp;&lt;name&gt;mapred.capacity-scheduler.queue.queueF.maximum-initialized-active-tasks-per-user&lt;/name&gt;</span>
<br>

<span class="codefrag">    &nbsp;&nbsp;&lt;value&gt;100000&lt;/value&gt;</span>
<br>

<span class="codefrag">  &lt;/property&gt;</span>
<br>

<span class="codefrag">  &lt;property&gt;</span>
<br>

<span class="codefrag">    &nbsp;&nbsp;&lt;name&gt;mapred.capacity-scheduler.queue.queueF.init-accept-jobs-factor&lt;/name&gt;</span>
<br>

<span class="codefrag">    &nbsp;&nbsp;&lt;value&gt;10&lt;/value&gt;</span>
<br>

<span class="codefrag">  &lt;/property&gt;</span>
<br>

<br>

<span class="codefrag">&lt;/configuration&gt;</span>
<br>
    
</td>
    
</tr>
    
</table>
</div>
  
</div>
<!--+
    |end content
    +-->
<div class="clearboth">&nbsp;</div>
</div>
<div id="footer">
<!--+
    |start bottomstrip
    +-->
<div class="lastmodified">
<script type="text/javascript"><!--
document.write("Last Published: " + document.lastModified);
//  --></script>
</div>
<div class="copyright">
        Copyright &copy;
         2008 <a href="http://www.apache.org/licenses/">The Apache Software Foundation.</a>
</div>
<!--+
    |end bottomstrip
    +-->
</div>
</body>
</html>
